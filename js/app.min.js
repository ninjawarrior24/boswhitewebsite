document.addEventListener("DOMContentLoaded",function(){const t=(new Date).getFullYear(),e=document.getElementById("year");e&&(e.textContent=t);const s=document.getElementById("navToggle"),i=document.getElementById("navLinks");s&&i&&(s.addEventListener("click",()=>{const t="flex"===i.style.display;i.style.display=t?"none":"flex",i.style.flexDirection="column",i.style.gap="8px",i.style.alignItems="flex-start"}),window.addEventListener("resize",()=>{window.innerWidth>700&&(i.style.display="flex",i.style.flexDirection="row")}));const r=document.querySelector(".the-nos");if(r){const t=r.querySelectorAll(".nos-layer");new IntersectionObserver((e,s)=>{e.forEach(e=>{e.isIntersecting&&(t.forEach(t=>t.classList.add("is-visible")),s.unobserve(e.target))})},{threshold:.2}).observe(r)}class n{constructor(t){this.root=t,this.track=t.querySelector(".carousel-track"),this.items=Array.from(t.querySelectorAll(".carousel-item")),this.n=this.items.length,0!==this.n&&(this.idx=0,this.auto="true"===t.dataset.autoplay,this.interval=parseInt(t.dataset.interval||4e3,10),this.timer=null,this._buildDots(),this._measureAndLayout(),this._bindEvents(),this.goTo(0,!1),setTimeout(()=>{this._measureAndLayout(),this.goTo(this.idx,!1)},120),this.auto&&this.start())}_buildDots(){if(this.dotsWrap=this.root.querySelector(".carousel-dots"),this.dotsWrap){this.dotsWrap.innerHTML="";for(let t=0;t<this.n;t++){const e=document.createElement("button");e.addEventListener("click",()=>this.goTo(t)),0===t&&e.classList.add("active"),this.dotsWrap.appendChild(e)}}}_measureAndLayout(){const t=this.root.offsetWidth||(this.track.parentElement?this.track.parentElement.offsetWidth:1e3);this.itemW=Math.round(Math.min(.6*t,1e3)),this.itemH=this.items[0]&&this.items[0].offsetHeight||Math.round(.56*this.itemW),this.root.style.perspective=this.root.style.perspective||"1200px",this.track.style.transformStyle="preserve-3d",this.track.style.position="relative",this.track.style.height=this.itemH+"px",this.spacingX=Math.round(.5*this.itemW),this.frontZ=160,this.stepZ=90,this.items.forEach((t,e)=>{t.style.position="absolute",t.style.left="50%",t.style.top="50%",t.style.width=Math.round(this.itemW)+"px",t.style.height=this.itemH+"px",t.style.transformOrigin="50% 50%",t.style.transition="transform 520ms cubic-bezier(.2,.9,.2,1), opacity 320ms"}),this.track.style.transition="transform 520ms cubic-bezier(.2,.9,.2,1)"}_bindEvents(){const t=this.root.querySelector(".carousel-prev"),e=this.root.querySelector(".carousel-next");t&&t.addEventListener("click",()=>this.prev()),e&&e.addEventListener("click",()=>this.next());let s=0,i=0,r=!1;this.track.addEventListener("pointerdown",t=>{r=!0,s=t.clientX,this.stop(),this.track.setPointerCapture&&this.track.setPointerCapture(t.pointerId)}),this.track.addEventListener("pointermove",t=>{r&&(i=t.clientX-s)}),this.track.addEventListener("pointerup",()=>{r=!1,Math.abs(i)>40&&(i<0?this.next():this.prev()),i=0,this.start()}),this.track.addEventListener("pointercancel",()=>{r=!1,i=0,this.start()}),window.addEventListener("resize",()=>{this._measureAndLayout(),this.goTo(this.idx,!1)})}goTo(t,e=!0){this.idx=(t%this.n+this.n)%this.n;for(let t=0;t<this.n;t++){const e=this.n;let s=t-this.idx;for(;s>e/2;)s-=e;for(;s<-e/2;)s+=e;const i=s,r=Math.abs(i);let n=0;n=0===r?0:1===r?Math.sign(i)*(.5*this.itemW+0):Math.sign(i)*(.5*this.itemW+(r-1)*(this.spacingX+20));const o=0===r?this.frontZ:-Math.min(r*this.stepZ,600),a=0===r?1.02:Math.max(1-.04*r,.7),h=this.items[t];h.style.transform=`translateX(${n}px) translateZ(${o}px) scale(${a}) translate(-50%,-50%)`,h.style.zIndex=0===r?3e3:String(100-Math.min(r,20)),h.style.opacity=r>4?"0":String(Math.max(1-.18*r,.18)),h.style.pointerEvents=0===r?"auto":"none",h.classList.toggle("active",0===r)}this.dotsWrap&&Array.from(this.dotsWrap.children).forEach((t,e)=>t.classList.toggle("active",e===this.idx)),e&&this._resetAuto()}next(){this.goTo(this.idx+1)}prev(){this.goTo(this.idx-1)}start(){this.timer||(this.timer=setInterval(()=>this.next(),this.interval))}stop(){this.timer&&(clearInterval(this.timer),this.timer=null)}_resetAuto(){this.stop(),this.auto&&this.start()}}document.querySelectorAll(".carousel").forEach(t=>new n(t))});